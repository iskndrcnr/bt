from selenium import webdriver
from selenium.webdriver.common.keys import Keys
from selenium.webdriver.common.by import By
from selenium.webdriver.chrome.options import Options
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
#from selenium.webdriver.chrome.service import Service as ChromeService
from selenium.common.exceptions import NoSuchElementException
from selenium.common.exceptions import TimeoutException
from webdriver_manager.chrome import ChromeDriverManager
from win32api import GetMonitorInfo, MonitorFromPoint
import pyautogui
import requests
import random
import time
import sys
import os
import re

#os.system("pause")

pcname = os.getlogin()
exec_path_chrome = "C:/Program Files/Google/Chrome/Application/chrome.exe"
exec_path_driver = ChromeDriverManager(path = r".\\").install()
ch_options = Options() #Chrome Options
user_data_dir = "user-data-dir=C:/Users/{}/AppData/Local/Google/Chrome/User Data".format(pcname)
ch_options.add_argument(user_data_dir) #Extract this path from "chrome://version/"
ch_options.add_experimental_option('excludeSwitches', ['enable-automation','enable-logging'])
ch_options.add_experimental_option('useAutomationExtension', False)
prefs = {"credentials_enable_service": False,"profile.password_manager_enabled": False}
ch_options.add_experimental_option("prefs", prefs)
driver = webdriver.Chrome(executable_path = exec_path_driver, options = ch_options)

driver.get("https://zqwqz.org/")
try:
	WebDriverWait(driver, 5).until(EC.presence_of_element_located((By.XPATH, "//a[@data-islem='login']")))
	login = driver.find_element(By.XPATH,"//a[@data-islem='login']")
	vidyo_url = login.click()
	time.sleep(2)
	WebDriverWait(driver, 5).until(EC.presence_of_element_located((By.XPATH, "//a[@data-islem='login']")))
	driver.find_element(By.ID, "email").send_keys("iskender.cinar@gmail.com")
	driver.find_element(By.ID, "sifre").send_keys("Isko2257.")
	driver.find_element(By.ID, "login").click()
	time.sleep(3)
except Exception as e:
	pass
	#raise e
WebDriverWait(driver, 5).until(EC.presence_of_element_located((By.CLASS_NAME, "cat tur")))
listeturs= driver.find_elements(By.CLASS_NAME, "cat tur")
turs = []
for tur in listeturs:
	turlink = tur.find_element(By.TAG_NAME, "a").get_attribute("href")
	turs.append(turlink)

for index1 in range(3, len(turs)):
	#driver.get("https://zqwqz.org/dizi/")
	link1 = turs[index1]
	driver.get(link1)
	
	WebDriverWait(driver, 5).until(EC.presence_of_element_located((By.CLASS_NAME, "listedizidetay")))
	listedizidetay = driver.find_element(By.CLASS_NAME, "dizlist").find_elements(By.CLASS_NAME, "title")
	links = []
	for dizi in listedizidetay:
		href = dizi.find_element(By.TAG_NAME, "a").get_attribute("href")
		links.append(href)

	for index in range(1, len(links)):
		link = links[index]
		print(link)
		driver.get(link)
		try:
			WebDriverWait(driver, 5).until(EC.presence_of_element_located((By.CLASS_NAME, "stars")))
			driver.find_elements(By.CLASS_NAME, "listedizidetay")
			rnd = "//label[@for='star-{}']".format(random.randint(3, 5))
			print(rnd)
			star = driver.find_element(By.XPATH, str(rnd))
			star.click()
			time.sleep(1)
		except Exception as e:
			#raise e
			pass
	
	
#time.sleep(30000)
